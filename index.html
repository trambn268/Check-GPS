<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Điểm danh GPS</title>
</head>
<body>
  <h2>Điểm danh sinh viên</h2>
  <form id="attendanceForm">
    <label>Họ và tên:</label><br>
    <input type="text" id="name" required><br><br>

    <label>Mã số sinh viên (MSSV):</label><br>
    <input type="text" id="mssv" required><br><br>

    <button type="submit">Gửi điểm danh</button>
  </form>

  <script>
    document.getElementById("attendanceForm").addEventListener("submit", function(e) {
      e.preventDefault();
      navigator.geolocation.getCurrentPosition(function(pos) {
        var lat = pos.coords.latitude;
        var lon = pos.coords.longitude;
        var formURL = "https://docs.google.com/forms/d/e/1FAIpQLSfcq5NlcENT1g1aVkTT9t0aQj-phEtT1VfgFR6xKQdg4t1-ng/formResponse";
        var entryName = "entry.NAME_ID";     // Họ và tên
        var entryMSSV = "entry.MSSV_ID";     // MSSV
        var entryGPS = "entry.GPS_ID";       // Vị trí GPS

        var formData = new FormData();
        formData.append(entryName, document.getElementById("name").value);
        formData.append(entryMSSV, document.getElementById("mssv").value);
        formData.append(entryGPS, lat + "," + lon);

        fetch(formURL, {
          method: "POST",
          mode: "no-cors",
          body: formData
        }).then(() => {
          document.body.innerHTML = `<h3>Điểm danh thành công!</h3><p>Vị trí: ${lat}, ${lon}</p>`;
        });
      }, function() {
        alert("Không lấy được vị trí. Vui lòng bật định vị!");
      });
    });
  </script>
</body>
</html>
